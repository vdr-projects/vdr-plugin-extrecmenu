#!/bin/sh

#MOUNTCMD="/bin/mount"
MOUNTCMD="/usr/bin/sudo mount"
#UMOUNTCMD="/bin/umount"
UMOUNTCMD="/usr/bin/sudo umount"
MOUNTPOINT="/media/cdrom/" # trailing '/' is important! (for find command)
PATH=$2
NAME=$3

case "$1" in
mount)
	# mount dvd
	$MOUNTCMD $MOUNTPOINT
	if [ $? -eq 0 ]
	then
		DIR=$(/usr/bin/find $MOUNTPOINT -name $NAME)
		# bind recording dir on dvd to recording dir in /video
		$MOUNTCMD --bind $DIR $PATH
		if [ $? -ne 0 ]
		then
			$UMOUNTCMD $MOUNTPOINT
			exit 2
		fi
        else
		exit 1
        fi
	;;
umount)
	$MOUNTCMD | /bin/grep $PATH > /dev/null
	if [ $? -eq 0 ]
	then
		$UMOUNTCMD $PATH
		$UMOUNTCMD $MOUNTPOINT
	fi
	;;
esac
